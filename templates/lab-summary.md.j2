# ADFR/DSP Lab Environment Summary

**Generated:** {{ ansible_date_time.iso8601 }}
**Deployment Duration:** {{ deployment_duration | default('N/A') }}

---

## Infrastructure Overview

### Network Configuration
- **Network:** 192.168.35.0/24 (VLAN 35)
- **Gateway:** 192.168.35.1
- **DNS Servers:**
  - Primary: 192.168.35.20 (KOA-DC)
  - Secondary: 192.168.35.30 (GRANITE-DC)

### Management Infrastructure

| Hostname | IP Address | Role | Status |
|----------|-----------|------|--------|
{% for host in groups['infrastructure'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | {{ hostvars[host]['role'] | default('Infrastructure') }} | {{ 'âœ“ Online' if hostvars[host]['connectivity_test'] is defined else '? Unknown' }} |
{% endfor %}

---

## Active Directory Forests

### arbor.lab Forest

**Domain:** arbor.lab
**NetBIOS:** ARBOR
**Domain SID:** {{ hostvars[groups['arbor_forest_root_pdc'][0]]['domain_sid'] | default('Unknown') }}

#### Domain Controllers

| Hostname | IP Address | Role | FSMO Roles |
|----------|-----------|------|------------|
{% for host in groups['arbor_forest_root_pdc'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Forest Root PDC | Schema Master, Domain Naming Master, PDC Emulator, RID Master |
{% endfor %}
{% for host in groups['arbor_forest_root_replica'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Forest Root Replica | Infrastructure Master |
{% endfor %}

#### Service Accounts
- `svc-adfr@arbor.lab` - ADFR Agent Service Account
- `svc-dsp@arbor.lab` - DSP Monitoring Service Account

---

### alpine.lab Forest

**Domain:** alpine.lab
**NetBIOS:** ALPINE
**Domain SID:** {{ hostvars[groups['alpine_forest_root_pdc'][0]]['domain_sid'] | default('Unknown') }}

#### Forest Root Domain (alpine.lab)

| Hostname | IP Address | Role | FSMO Roles |
|----------|-----------|------|------------|
{% for host in groups['alpine_forest_root_pdc'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Forest Root PDC | Schema Master, Domain Naming Master, PDC Emulator, RID Master |
{% endfor %}
{% for host in groups['alpine_forest_root_replica'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Forest Root Replica | Infrastructure Master |
{% endfor %}

#### Child Domain: mauna.alpine.lab

**NetBIOS:** MAUNA
**Domain SID:** {{ hostvars[groups['mauna_child_pdc'][0]]['domain_sid'] | default('Unknown') }}

| Hostname | IP Address | Role | FSMO Roles |
|----------|-----------|------|------------|
{% for host in groups['mauna_child_pdc'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Child Domain PDC | PDC Emulator, RID Master |
{% endfor %}
{% for host in groups['mauna_child_replica'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Child Domain Replica | Infrastructure Master |
{% endfor %}

#### Child Domain: rainier.alpine.lab

**NetBIOS:** RAINIER
**Domain SID:** {{ hostvars[groups['rainier_child_pdc'][0]]['domain_sid'] | default('Unknown') }}

| Hostname | IP Address | Role | FSMO Roles |
|----------|-----------|------|------------|
{% for host in groups['rainier_child_pdc'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Child Domain PDC | PDC Emulator, RID Master |
{% endfor %}
{% for host in groups['rainier_child_replica'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Child Domain Replica | Infrastructure Master |
{% endfor %}

#### Service Accounts
- `svc-adfr@alpine.lab` - ADFR Agent Service Account
- `svc-dsp@alpine.lab` - DSP Monitoring Service Account

---

## Recovery Environment

| Hostname | IP Address | Purpose |
|----------|-----------|---------|
{% for host in groups['recovery_vms'] | default([]) %}
| {{ host }} | {{ hostvars[host]['ansible_host'] }} | Recovery VM (Standby) |
{% endfor %}

---

## Resource Summary

### Total Resources Deployed

| Resource | Count |
|----------|-------|
| Total VMs | {{ groups['all'] | length }} |
| Infrastructure VMs | {{ groups['infrastructure'] | default([]) | length }} |
| Domain Controllers | {{ groups['domain_controllers'] | default([]) | length }} |
| Recovery VMs | {{ groups['recovery_vms'] | default([]) | length }} |
| Active Directory Forests | 2 |
| Active Directory Domains | 4 |

### VM Distribution by Proxmox Host

| Host | VMs |
|------|-----|
| semperis-nuc-1 (192.168.33.21) | {{ groups['all'] | map('extract', hostvars) | selectattr('proxmox_host', 'equalto', '192.168.33.21') | list | length }} |
| semperis-nuc-2 (192.168.33.22) | {{ groups['all'] | map('extract', hostvars) | selectattr('proxmox_host', 'equalto', '192.168.33.22') | list | length }} |

---

## Lab Exercises

### Available Scenarios

1. **Basic Forest Recovery**
   - Simulate DC failure in arbor.lab
   - Recover to MESA-R01 recovery VM
   - Validate AD functionality

2. **Multi-Domain Recovery**
   - Simulate complete alpine.lab forest compromise
   - Recover all domains to clean recovery VMs
   - Verify cross-domain trusts

3. **Distribution Point Failover**
   - Simulate RIDGE failure
   - Test failover to CREST
   - Measure RTO/RPO

4. **DSP Threat Detection**
   - Simulate privilege escalation
   - Verify DSP detection and alerting
   - Test auto-remediation

5. **IP Remapping Recovery**
   - Recover DCs to different IP scheme
   - Test ADFR IP remapping capabilities

---

## Connection Information

### Remote Desktop Connections

Import the mRemoteNG configuration file: